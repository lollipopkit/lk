[package]
name = "lkr-core"
description = "Core library for LKR (Query Check Language)"
version = "0.2.0"
edition = "2024"
authors = ["lollipopkit <a@lpkt.cn>"]
license = "Apache-2.0"

[lib]
name = "lkr_core"
crate-type = ["rlib", "staticlib"]

[features]
default = ["llvm"]
llvm = ["dep:llvm-tools"]

[dependencies]
anyhow = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }
serde_yaml = { workspace = true }
toml = { workspace = true }
once_cell = { workspace = true }
tokio = { workspace = true }
futures = { workspace = true }
dashmap = { workspace = true }
tracing = { workspace = true }
chrono = { workspace = true }
tempfile = { workspace = true }
llvm-tools = { workspace = true, optional = true }
rustc-hash = { version = "2" }
itoa = { version = "1" }
ryu = { version = "1" }

[dev-dependencies]
criterion = "0"

[[bench]]
name = "bench_main"
harness = false

[[bench]]
name = "slots_bench"
harness = false

[[bench]]
name = "call_named_bench"
harness = false

[[bench]]
name = "scripts_bench"
harness = false

[[bin]]
name = "perf_dashboard"
path = "../scripts/perf_dashboard.rs"
